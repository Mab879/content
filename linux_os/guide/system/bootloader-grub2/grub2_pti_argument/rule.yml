documentation_complete: true

prodtype: fedora,ol8,ol9,rhel8,rhel9

title: 'Enable Kernel Page-Table Isolation (KPTI)'

description: |-
    To enable Kernel page-table isolation,
    add the argument <tt>pti=on</tt> to the default
    GRUB 2 command line for the Linux operating system.
    {{{ describe_grub2_argument("pti=on") | indent(4) }}}

rationale: |-
    Kernel page-table isolation is a kernel feature that mitigates
    the Meltdown security vulnerability and hardens the kernel
    against attempts to bypass kernel address space layout
    randomization (KASLR).

severity: low

identifiers:
    cce@rhel8: CCE-82194-2
    cce@rhel9: CCE-83843-3

references:
    disa: CCI-000381
    nist: SI-16
    srg: SRG-OS-000433-GPOS-00193,SRG-OS-000095-GPOS-00049
    stigid@ol8: OL08-00-040004
    stigid@rhel8: RHEL-08-040004

ocil_clause: 'Kernel page-table isolation is not enabled'

ocil: |-
    {{{ ocil_grub2_argument("pti=on") | indent(4) }}}

platform: machine

template:
    name: grub2_bootloader_argument
    vars:
        arg_name: pti
        arg_value: 'on'

fixtext: |-
    Configure {{{ full_name }}} to enable kernel page-table isolation with the following command:

    $ sudo grubby --update-kernel=ALL --args="pti=on"

    Add or modify the following line in "/etc/default/grub" to ensure the configuration survives kernel updates:

    GRUB_CMDLINE_LINUX="pti=on"

srg_requirement:
  {{{ full_name }}} must enable mitigations against processor-based vulnerabilities.

checktext: |-
    Verify {{{ full_name }}} enables kernel page-table isolation with the following command:

    $ sudo grubby --info=ALL | grep pti

    args="ro crashkernel=auto resume=/dev/mapper/rhel-swap rd.lvm.lv=rhel/root rd.lvm.lv=rhel/swap rhgb quiet fips=1 audit=1 audit_backlog_limit=8192 pti=on

    If the "pti" entry does not equal "on", or is missing, this is a finding.

    Check that kernel page-table isolation is enabled by default to persist in kernel updates:

    $ sudo grep pti /etc/default/grub

    GRUB_CMDLINE_LINUX="pti=on"

    If "pti" is not set to "on", is missing or commented out, this is a finding.
