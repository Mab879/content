documentation_complete: true

prodtype: fedora,ol8,ol9,rhcos4,rhel7,rhel8,rhel9

title: 'Disable CAN Support'

description: |-
    The Controller Area Network (CAN) is a serial communications
    protocol which was initially developed for automotive and
    is now also used in marine, industrial, and medical applications.
    {{{ describe_module_disable(module="can") }}}

rationale: |-
    Disabling CAN protects the system against exploitation of any
    flaws in its implementation.

severity: medium

identifiers:
    cce@rhcos4: CCE-82519-0
    cce@rhel7: CCE-82164-5
    cce@rhel8: CCE-82059-7
    cce@rhel9: CCE-84134-6

references:
    disa: CCI-000381,CCI-000366
    nist: AC-18
    ospp: FMT_SMF_EXT.1
    srg: SRG-OS-000095-GPOS-00049,SRG-OS-000480-GPOS-00227
    stigid@ol8: OL08-00-040022
    stigid@rhel8: RHEL-08-040022

{{{ complete_ocil_entry_module_disable(module="can") }}}

fixtext: |-
    To configure the system to prevent the can kernel module from being loaded, add the following line to the file  /etc/modprobe.d/can.conf (or create atm.conf if it does not exist):

    blacklist can

srg_requirement: |-
    {{{ full_name }}} Must Be Configured To Disable Non-Essential Capabilities.

template:
    name: kernel_module_disabled
    vars:
        kernmodule: can

checktext: |-

    If the system is configured to prevent the loading of the  can  kernel module,
    it will contain lines inside any file in  /etc/modprobe.d  or the deprecated /etc/modprobe.conf .
    These lines instruct the module loading system to run another program (such as  /bin/true ) upon a module  install  event.
    Run the following command to search for such lines in all files in  /etc/modprobe.d  and the deprecated  /etc/modprobe.conf :
     $ grep -r can /etc/modprobe.conf /etc/modprobe.d

    If no line is returned, then this is a finding.
