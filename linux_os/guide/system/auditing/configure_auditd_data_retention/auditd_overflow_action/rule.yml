{{%- if product in ["rhel7", "ol7"] %}}
  {{%- set auditd_conf_path = audisp_conf_path + "/audispd.conf" %}}
{{%- else %}}
  {{%- set auditd_conf_path = audisp_conf_path + "/auditd.conf" %}}
{{%- endif %}}

documentation_complete: true

title: Appropriate Action Must be Setup When the Internal Audit Event Queue is Full

description: |-
    The audit system should have an action setup in the event the internal event queue becomes full.
    To setup an overflow action edit <tt>{{{ auditd_conf_path }}}</tt>. Set <tt>overflow_action</tt>
    to one of the following values: <tt>syslog</tt>, <tt>single</tt>, <tt>halt</tt>.


rationale: |-
    The audit system should have an action setup in the event the internal event queue becomes full
    so that no data is lost.

severity: medium

identifiers:
    cce@rhel7: CCE-88073-2
    cce@rhel8: CCE-85889-4
    cce@rhel9: CCE-87901-5

references:
    disa: CCI-001851
    nist: AU-4(1)
    srg: SRG-OS-000342-GPOS-00133,SRG-OS-000479-GPOS-00224
    stigid@ol7: OL07-00-030210
    stigid@ol8: OL08-00-030700
    stigid@rhel7: RHEL-07-030210
    stigid@rhel8: RHEL-08-030700

ocil_clause: 'auditd overflow action is not set correctly'

ocil: |-
    Verify the audit system is configured to take an appropriate action when the internal event queue is full:
    <pre>$ sudo grep -i overflow_action {{{ auditd_conf_path }}}</pre>

    The output should contain <tt>overflow_action = syslog</tt>

    If the value of the "overflow_action" option is not set to <tt>syslog</tt>,
    <tt>single</tt>, <tt>halt</tt> or the line is commented out, ask the System Administrator
    to indicate how the audit logs are off-loaded to a different system or media.

fixtext: |-
    Edit the /etc/audit/auditd.conf file and add or update the "overflow_action" option:

    overflow_action = syslog

    The audit daemon must be restarted for changes to take effect.

srg_requirement: |-
    {{{ full_name }}} must take appropriate action when the internal event queue is full.
    {{{ full_name }}} must take an action when the internal audit event queue is full.

checktext: |-
    Verify that {{{ full_name }}} audit system is configured to take an appropriate action when the internal event queue is full:

     $ sudo grep -i overflow_action /etc/audit/auditd.conf

    overflow_action = syslog

    If the value of the "overflow_action" option is not set to "syslog", "single", "halt" or the line is commented out, ask the System Administrator to indicate how the audit logs are off-loaded to a different system or media.

    If there is no evidence that the transfer of the audit logs being off-loaded to another system or media takes appropriate action if the internal event queue becomes full, this is a finding.
