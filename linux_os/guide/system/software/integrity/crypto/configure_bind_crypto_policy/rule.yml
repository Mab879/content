documentation_complete: true

prodtype: alinux2,alinux3,fedora,ol8,ol9,rhcos4,rhel8,rhel9,rhv4,uos20

title: 'Configure BIND to use System Crypto Policy'

description: |-
    Crypto Policies provide a centralized control over crypto algorithms usage of many packages.
    BIND is supported by crypto policy, but the BIND configuration may be
    set up to ignore it.

    To check that Crypto Policies settings are configured correctly, ensure that the <tt>/etc/named.conf</tt>
    includes the appropriate configuration:
    In the <tt>options</tt> section of <tt>/etc/named.conf</tt>, make sure that the following line
    is not commented out or superseded by later includes:
    <tt>include "/etc/crypto-policies/back-ends/bind.config";</tt>

rationale: |-
    Overriding the system crypto policy makes the behavior of the BIND service violate expectations,
    and makes system configuration more fragmented.

severity: high

identifiers:
    cce@rhcos4: CCE-82544-8
    cce@rhel8: CCE-80934-3
    cce@rhel9: CCE-83451-5

references:
    nerc-cip: CIP-003-8 R4.2,CIP-007-3 R5.1
    nist: SC-13,SC-12(2),SC-12(3)
    srg: SRG-OS-000423-GPOS-00187,SRG-OS-000426-GPOS-00190
    stigid@ol8: OL08-00-010020
    stigid@rhel8: RHEL-08-010020

ocil_clause: |-
    BIND is installed and the BIND config file doesn't contain the
    <pre>include "/etc/crypto-policies/back-ends/bind.config";</pre> directive

ocil: |-
    To verify that BIND uses the system crypto policy, check out that the BIND config file
    <pre>/etc/named.conf</pre> contains the <pre>include "/etc/crypto-policies/back-ends/bind.config";</pre>
    directive:
    <pre>$ sudo grep 'include "/etc/crypto-policies/back-ends/bind.config";' /etc/named.conf</pre>
    Verify that the directive is at the bottom of the <pre>options</pre> section of the config file.

fixtext: |-
    Configure BIND to use the system crypto policy.

    Add the following line to the "options" section in "/etc/named.conf":

    include "/etc/crypto-policies/back-ends/bind.config";

srg_requirement: |-
    {{{ full_name }}} must implement DoD-approved encryption in the bind package.
srg_requirement: '{{{ full_name }}} BIND crypto policy must use approved ciphers.'

vuldiscussion: |-
    Without protection of the transmitted information, confidentiality and integrity may be compromised because unprotected communications can be intercepted and either read or altered.

    This requirement applies to both internal and external networks and all types of information system components from which information can be transmitted (e.g., servers, mobile devices, notebook computers, printers, copiers, scanners, and facsimile machines). Communication paths outside the physical protection of a controlled boundary are exposed to the possibility of interception and modification.

    Protecting the confidentiality and integrity of organizational information can be accomplished by physical means (e.g., employing physical distribution systems) or by logical means (e.g., employing cryptographic techniques). If physical means of protection are employed, then logical means (cryptography) do not have to be employed, and vice versa.

checktext: |-
    Verify that BIND uses the system crypto policy with the following command:

    If bind is not installed, this is not applicable.

     $ sudo grep include /etc/named.conf

    include "/etc/crypto-policies/back-ends/bind.config";'

    If BIND is installed and the BIND config file doesn't contain the  include "/etc/crypto-policies/back-ends/bind.config" directive, or the line is commented out, this is a finding.
