documentation_complete: true

prodtype: alinux2,alinux3,fedora,ol7,ol8,ol9,rhel7,rhel8,rhel9,rhv4,sle12,sle15,ubuntu2004,ubuntu2204

title: 'Remove the X Windows Package Group'

description: |-
    By removing the xorg-x11-server-common package, the system no longer has X Windows
    installed. If X Windows is not installed then the system cannot boot into graphical user mode.
    This prevents the system from being accidentally or maliciously booted into a <tt>graphical.target</tt>
    mode. To do so, run the following command:
    {{%- if product in ['rhel8', 'rhel9'] or product == "rhv4" -%}}
    <pre>$ sudo {{{ pkg_manager }}} groupremove base-x</pre>
    {{%- else %}}
    <pre>$ sudo {{{ pkg_manager }}} groupremove "X Window System"</pre>
    {{%- endif %}}
    <pre>$ sudo {{{ pkg_manager }}} remove xorg-x11-server-common</pre>

rationale: |-
    Unnecessary service packages must not be installed to decrease the attack surface of the system. X windows has a long history of security
    vulnerabilities and should not be installed unless approved and documented.

severity: medium

identifiers:
    cce@rhel7: CCE-27218-7
    cce@rhel8: CCE-82757-6
    cce@rhel9: CCE-84104-9

references:
    cis-csc: 12,15,8
    cis@alinux2: 2.1.2
    cis@alinux3: 2.2.2
    cis@rhel7: 2.2.2
    cis@rhel8: 2.2.2
    cis@sle12: 2.2.2
    cis@sle15: 2.2.2
    cis@ubuntu2004: 2.2.2
    cis@ubuntu2204: 2.2.2
    cobit5: APO13.01,DSS01.04,DSS05.02,DSS05.03
    disa: CCI-000366
    isa-62443-2009: 4.3.3.6.6
    isa-62443-2013: 'SR 1.13,SR 2.6,SR 3.1,SR 3.5,SR 3.8,SR 4.1,SR 4.3,SR 5.1,SR 5.2,SR 5.3,SR 7.1,SR 7.6'
    iso27001-2013: A.11.2.6,A.13.1.1,A.13.2.1,A.14.1.3,A.6.2.1,A.6.2.2
    nist: CM-7(a),CM-7(b),CM-6(a)
    nist-csf: PR.AC-3,PR.PT-4
    srg: SRG-OS-000480-GPOS-00227

ocil_clause: 'the X Windows package group or xorg-x11-server-common has not be removed'

ocil: |-
    To ensure the X Windows package group is removed, run the following command:
    <pre>$ rpm -qi xorg-x11-server-common</pre>
    The output should be:
    <pre>package xorg-x11-server-common is not installed</pre>

warnings:
    - functionality: |-
        The installation and use of a Graphical User Interface (GUI) increases your attack vector and decreases your
        overall security posture. Removing the package xorg-x11-server-common package will remove the graphical target
        which might bring your system to an inconsistent state requiring additional configuration to access the system
        again. If a GUI is an operational requirement, a tailored profile that removes this rule should used before
        continuing installation.

template:
    name: package_removed
    vars:
        pkgname: xorg-x11-server-common
        pkgname@ubuntu1604: xserver-xorg
        pkgname@ubuntu1804: xserver-xorg
        pkgname@ubuntu2004: xserver-xorg

srg_requirement: |-
    A graphical display manager must not be installed on {{{ full_name }}} unless approved.

checktext: |-
    Verify that a graphical user interface is not installed with the following command:

    $ sudo dnf list --installed "xorg*common"

    Error: No matching Packages to list

    If the x11-server-common package is installed and the use of a graphical user interface has not been documented with the Information System Security Officer (ISSO) as an operational requirement, this is a finding.

fixtext: |-
    Document the requirement for a graphical user interface with the ISSO or remove all xorg packages with the following command:

    Warning: If you are accessing the system through the graphical user interface, change to the multi-user.target with the following command:

    $ sudo systemctl isolate multi-user.target

    Warning: Removal of the graphical user interface will immediately render it useless. The following commands should not be run from a virtual terminal emulator in the graphical interface.

    $ sudo dnf remove "xorg*"
    $ sudo systemctl set-default multi-user.target
