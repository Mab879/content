documentation_complete: true

prodtype: fedora,ol8,ol9,rhcos4,rhel8,rhel9

title: 'Enable the USBGuard Service'

description: |-
    The USBGuard service should be enabled.
    {{{ describe_service_enable(service="usbguard") }}}

rationale: |-
    The <tt>usbguard</tt> service must be running in order to
    enforce the USB device authorization policy for all USB devices.

severity: medium

platform: machine

identifiers:
    cce@rhcos4: CCE-82537-2
    cce@rhel8: CCE-82853-3
    cce@rhel9: CCE-84205-4

references:
    disa: CCI-000416,CCI-001958
    ism: "1418"
    nist: CM-8(3)(a),IA-3
    ospp: FMT_SMF_EXT.1
    srg: SRG-OS-000378-GPOS-00163
    stigid@ol8: OL08-00-040141
    stigid@rhel8: RHEL-08-040141

ocil_clause: 'the service is not enabled'

ocil: |-
    {{{ ocil_service_enabled(service="usbguard") }}}

template:
    name: service_enabled
    vars:
        servicename: usbguard

fixtext: |-
    To enable the USBGuard service run the following command:

    $ sudo systemctl enable --now usbguard

srg_requirement: |-
    {{{ full_name }}} must have the USBGuard package enabled.
srg_requirement: '{{{ srg_requirement_service_enabled("usbguard") }}}'

checktext: |-
    Verify {{{ full_name }}} has USBGuard enabled with the following command:

    $ systemctl is-active usbguard

    active

    If usbguard is not active, ask the SA to indicate how unauthorized peripherals are being blocked.
    If there is no evidence that unauthorized peripherals are being blocked before establishing a connection, this is a finding.
